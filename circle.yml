machine:
  node:
    version: 8

dependencies:
  override:
    - npm install
    - npm install $CYPRESS_NPM_PACKAGE_NAME
  cache_directories:
    - node_modules

test:
  override:
    # record against staging environment
    - CYPRESS_ENV=staging CYPRESS_PROJECT_ID=$STAGING_PROJECT_ID CYPRESS_RECORD_KEY=$STAGING_RECORD_KEY $(npm bin)/cypress run --record --group --group-id $CIRCLE_BUILD_NUM
    # record against production environment
    # - $(npm bin)/cypress run --group --group-id $CIRCLE_BUILD_NUM
